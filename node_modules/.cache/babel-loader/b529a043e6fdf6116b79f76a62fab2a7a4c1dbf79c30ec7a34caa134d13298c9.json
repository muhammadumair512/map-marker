{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\CREATIVE_SOLUTIONS\\\\Desktop\\\\bolt\\\\bolt codesandbox\\\\src\\\\App.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$(),\n  _s4 = $RefreshSig$();\n// App.jsx\nimport React, { useState, useRef, useEffect } from \"react\";\nimport { MapContainer, TileLayer, Marker, Tooltip, useMap } from \"react-leaflet\";\nimport \"leaflet/dist/leaflet.css\";\nimport Papa from \"papaparse\";\nimport L from \"leaflet\";\nimport \"leaflet-draw/dist/leaflet.draw.css\";\nimport \"leaflet-draw\";\nimport booleanPointInPolygon from \"@turf/boolean-point-in-polygon\";\nimport { point, polygon } from \"@turf/helpers\";\nimport * as XLSX from \"xlsx\";\nimport MarkerClusterGroup from \"react-leaflet-cluster\";\n\n// Custom icons\nimport CustomMarkerIconImage from \"./custom-marker.png\";\nimport DotIconImage from \"./small-dot.png\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CustomMarkerIcon = L.icon({\n  iconUrl: CustomMarkerIconImage,\n  iconSize: [30, 40],\n  iconAnchor: [15, 40],\n  popupAnchor: [0, -40]\n});\nconst DotIcon = L.icon({\n  iconUrl: DotIconImage,\n  iconSize: [10, 10],\n  iconAnchor: [5, 5]\n});\n\n// ----- State dropdown data remains the same -----\nconst states = [{\n  name: \"Pennsylvania\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/master/pa_pennsylvania_zip_codes_geo.min.json\"\n}, {\n  name: \"Alabama\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/al_alabama_zip_codes_geo.min.json\"\n}, {\n  name: \"Alaska\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ak_alaska_zip_codes_geo.min.json\"\n}, {\n  name: \"Arizona\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/az_arizona_zip_codes_geo.min.json\"\n}, {\n  name: \"Arkansas\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ar_arkansas_zip_codes_geo.min.json\"\n}, {\n  name: \"California\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ca_california_zip_codes_geo.min.json\"\n}, {\n  name: \"Colorado\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/co_colorado_zip_codes_geo.min.json\"\n}, {\n  name: \"Connecticut\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ct_connecticut_zip_codes_geo.min.json\"\n}, {\n  name: \"Delaware\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/de_delaware_zip_codes_geo.min.json\"\n}, {\n  name: \"District of Columbia\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/dc_district_of_columbia_zip_codes_geo.min.json\"\n}, {\n  name: \"Florida\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/fl_florida_zip_codes_geo.min.json\"\n}, {\n  name: \"Georgia\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ga_georgia_zip_codes_geo.min.json\"\n}, {\n  name: \"Hawaii\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/hi_hawaii_zip_codes_geo.min.json\"\n}, {\n  name: \"Idaho\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/id_idaho_zip_codes_geo.min.json\"\n}, {\n  name: \"Illinois\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/il_illinois_zip_codes_geo.min.json\"\n}, {\n  name: \"Indiana\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/in_indiana_zip_codes_geo.min.json\"\n}, {\n  name: \"Iowa\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ia_iowa_zip_codes_geo.min.json\"\n}, {\n  name: \"Kansas\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ks_kansas_zip_codes_geo.min.json\"\n}, {\n  name: \"Kentucky\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ky_kentucky_zip_codes_geo.min.json\"\n}, {\n  name: \"Louisiana\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/la_louisiana_zip_codes_geo.min.json\"\n}, {\n  name: \"Maine\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/me_maine_zip_codes_geo.min.json\"\n}, {\n  name: \"Maryland\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/md_maryland_zip_codes_geo.min.json\"\n}, {\n  name: \"Massachusetts\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ma_massachusetts_zip_codes_geo.min.json\"\n}, {\n  name: \"Michigan\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/mi_michigan_zip_codes_geo.min.json\"\n}, {\n  name: \"Minnesota\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/mn_minnesota_zip_codes_geo.min.json\"\n}, {\n  name: \"Mississippi\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ms_mississippi_zip_codes_geo.min.json\"\n}, {\n  name: \"Missouri\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/mo_missouri_zip_codes_geo.min.json\"\n}, {\n  name: \"Montana\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/mt_montana_zip_codes_geo.min.json\"\n}, {\n  name: \"Nebraska\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ne_nebraska_zip_codes_geo.min.json\"\n}, {\n  name: \"Nevada\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/nv_nevada_zip_codes_geo.min.json\"\n}, {\n  name: \"New Hampshire\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/nh_new_hampshire_zip_codes_geo.min.json\"\n}, {\n  name: \"New Jersey\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/nj_new_jersey_zip_codes_geo.min.json\"\n}, {\n  name: \"New Mexico\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/nm_new_mexico_zip_codes_geo.min.json\"\n}, {\n  name: \"New York\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ny_new_york_zip_codes_geo.min.json\"\n}, {\n  name: \"North Carolina\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/nc_north_carolina_zip_codes_geo.min.json\"\n}, {\n  name: \"North Dakota\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/nd_north_dakota_zip_codes_geo.min.json\"\n}, {\n  name: \"Ohio\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/oh_ohio_zip_codes_geo.min.json\"\n}, {\n  name: \"Oklahoma\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ok_oklahoma_zip_codes_geo.min.json\"\n}, {\n  name: \"Oregon\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/or_oregon_zip_codes_geo.min.json\"\n}, {\n  name: \"Rhode Island\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ri_rhode_island_zip_codes_geo.min.json\"\n}, {\n  name: \"South Carolina\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/sc_south_carolina_zip_codes_geo.min.json\"\n}, {\n  name: \"South Dakota\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/sd_south_dakota_zip_codes_geo.min.json\"\n}, {\n  name: \"Tennessee\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/tn_tennessee_zip_codes_geo.min.json\"\n}, {\n  name: \"Texas\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/tx_texas_zip_codes_geo.min.json\"\n}, {\n  name: \"Utah\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ut_utah_zip_codes_geo.min.json\"\n}, {\n  name: \"Vermont\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/vt_vermont_zip_codes_geo.min.json\"\n}, {\n  name: \"Virginia\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/va_virginia_zip_codes_geo.min.json\"\n}, {\n  name: \"Washington\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/wa_washington_zip_codes_geo.min.json\"\n}, {\n  name: \"West Virginia\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/wv_west_virginia_zip_codes_geo.min.json\"\n}, {\n  name: \"Wisconsin\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/wi_wisconsin_zip_codes_geo.min.json\"\n}, {\n  name: \"Wyoming\",\n  url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/wy_wyoming_zip_codes_geo.min.json\"\n}];\n\n// ----------------------------------\n// ZipOverlay – unchanged\n// ----------------------------------\nfunction ZipOverlay(_ref) {\n  _s();\n  let {\n    zipUrl\n  } = _ref;\n  const map = useMap();\n  const layersCache = useRef({});\n  useEffect(() => {\n    if (!zipUrl) return;\n    Object.values(layersCache.current).forEach(layer => map.removeLayer(layer));\n    let currentLayer;\n    if (layersCache.current[zipUrl]) {\n      currentLayer = layersCache.current[zipUrl];\n      currentLayer.addTo(map);\n    } else {\n      fetch(zipUrl).then(res => res.json()).then(geoData => {\n        currentLayer = L.geoJSON(geoData, {\n          style: {\n            color: \"#ff7800\",\n            weight: 1,\n            fillColor: \"#ffeda0\",\n            fillOpacity: 0.4\n          },\n          onEachFeature: (feature, layerInstance) => {\n            const zip = feature.properties.ZCTA5CE10 || \"Unknown ZIP\";\n            layerInstance.bindPopup(\"ZIP Code: \".concat(zip));\n          }\n        });\n        layersCache.current[zipUrl] = currentLayer;\n        currentLayer.addTo(map);\n      }).catch(err => console.error(\"Error fetching ZIP code GeoJSON:\", err));\n    }\n    return () => {\n      if (currentLayer) map.removeLayer(currentLayer);\n    };\n  }, [map, zipUrl]);\n  return null;\n}\n\n// ----------------------------------\n// DrawHandler – unchanged (just shortened comments)\n// ----------------------------------\n_s(ZipOverlay, \"RJbtr0yo5/9yZFwpq+M4DEOqAUc=\", false, function () {\n  return [useMap];\n});\n_c = ZipOverlay;\nfunction DrawHandler(_ref2) {\n  _s2();\n  let {\n    setShapeFilteredData,\n    pricingDataRef,\n    locationsRef,\n    setDeleteFunction,\n    acreageFilteredDataRef\n  } = _ref2;\n  const map = useMap();\n  const [controlAdded, setControlAdded] = useState(false);\n  const drawnItemsRef = useRef(null);\n  const shapesArrayRef = useRef([]);\n  const selectedShapeRef = useRef(null);\n  const isPointInShape = (lat, lng, layer) => {\n    if (layer instanceof L.Circle || layer instanceof L.CircleMarker) {\n      const center = layer.getLatLng();\n      const radius = layer.getRadius();\n      return map.distance(center, L.latLng(lat, lng)) <= radius;\n    }\n    const shapeGeoJSON = layer.toGeoJSON();\n    const polygonGeometry = polygon(shapeGeoJSON.geometry.coordinates);\n    return booleanPointInPolygon(point([lng, lat]), polygonGeometry);\n  };\n  const handleShapeDrawn = layer => {\n    shapesArrayRef.current.push(layer);\n    layer.on(\"click\", () => {\n      selectedShapeRef.current = layer;\n    });\n\n    // Use filtered data if available, else entire pricing data\n    const currentPricingData = acreageFilteredDataRef.current.length ? acreageFilteredDataRef.current : pricingDataRef.current;\n    const filteredPricing = currentPricingData.filter(p => {\n      const [lat, lng] = p.coords;\n      return isPointInShape(lat, lng, layer);\n    });\n    const filteredComps = locationsRef.current.filter(loc => {\n      const [lat, lng] = loc.coords;\n      return isPointInShape(lat, lng, layer);\n    });\n    const combinedData = [...filteredPricing.map(item => ({\n      type: \"pricing\",\n      apn: item.apn,\n      lotAcreage: item.lotAcreage,\n      latitude: item.coords[0],\n      longitude: item.coords[1]\n    })), ...filteredComps.map(item => ({\n      type: \"comps\",\n      price: item.details.PRICE,\n      acres: item.details.ACRES,\n      latitude: item.coords[0],\n      longitude: item.coords[1]\n    }))];\n    setShapeFilteredData(combinedData);\n    console.log(\"Shape Filtered Data:\", combinedData);\n  };\n  useEffect(() => {\n    if (!controlAdded) {\n      const drawnItems = new L.FeatureGroup();\n      drawnItemsRef.current = drawnItems;\n      map.addLayer(drawnItems);\n      const drawControl = new L.Control.Draw({\n        draw: {\n          marker: false,\n          polyline: false,\n          circle: {\n            shapeOptions: {\n              color: \"#ff0000\"\n            },\n            showRadius: true\n          },\n          circlemarker: false,\n          polygon: {\n            shapeOptions: {\n              color: \"#0000ff\"\n            },\n            showArea: true\n          },\n          rectangle: {\n            shapeOptions: {\n              color: \"#00ff00\"\n            }\n          }\n        },\n        edit: {\n          featureGroup: drawnItems\n        }\n      });\n      map.addControl(drawControl);\n      setControlAdded(true);\n      map.on(\"draw:created\", e => {\n        const {\n          layer\n        } = e;\n        drawnItems.addLayer(layer);\n        handleShapeDrawn(layer);\n      });\n      setDeleteFunction(() => {\n        if (selectedShapeRef.current && drawnItemsRef.current) {\n          drawnItemsRef.current.removeLayer(selectedShapeRef.current);\n          shapesArrayRef.current = shapesArrayRef.current.filter(shape => shape !== selectedShapeRef.current);\n          selectedShapeRef.current = null;\n        } else if (shapesArrayRef.current.length > 0) {\n          const lastShape = shapesArrayRef.current.pop();\n          if (lastShape && drawnItemsRef.current) {\n            drawnItemsRef.current.removeLayer(lastShape);\n          }\n        }\n      });\n    }\n  }, [map, controlAdded, pricingDataRef, locationsRef, setShapeFilteredData, setDeleteFunction, acreageFilteredDataRef]);\n  return null;\n}\n\n// ----------------------------------\n// App\n// ----------------------------------\n_s2(DrawHandler, \"0Vjk56DwBpY3/aOwBBcB/RsDvz4=\", false, function () {\n  return [useMap];\n});\n_c2 = DrawHandler;\nfunction App() {\n  _s3();\n  const [selectedStateUrl, setSelectedStateUrl] = useState(states[0].url);\n  const [locations, setLocations] = useState([]);\n  const [pricingData, setPricingData] = useState([]);\n  const [shapeFilteredData, setShapeFilteredData] = useState([]);\n  const [acreageFilteredData, setAcreageFilteredData] = useState([]);\n  const [minAcreage, setMinAcreage] = useState(\"\");\n  const [maxAcreage, setMaxAcreage] = useState(\"\");\n\n  // For progress bars\n  const [mainCSVProgress, setMainCSVProgress] = useState(0);\n  const [pricingCSVProgress, setPricingCSVProgress] = useState(0);\n\n  // Refs\n  const pricingDataRef = useRef(pricingData);\n  const locationsRef = useRef(locations);\n  const acreageFilteredDataRef = useRef(acreageFilteredData);\n  const mapRef = useRef(null);\n  const deleteLastShapeRef = useRef(() => {});\n\n  // Keep references in sync\n  useEffect(() => {\n    pricingDataRef.current = pricingData;\n  }, [pricingData]);\n  useEffect(() => {\n    locationsRef.current = locations;\n  }, [locations]);\n  useEffect(() => {\n    acreageFilteredDataRef.current = acreageFilteredData;\n  }, [acreageFilteredData]);\n\n  // ----------------------------------\n  // Generic CSV parse with progress\n  // ----------------------------------\n  const parseCSVWithProgress = (file, onRowParsed, onComplete, onProgress) => {\n    // 1) First read the entire file as text to estimate #lines (minus header).\n    const reader = new FileReader();\n    reader.onload = e => {\n      const text = e.target.result;\n      const allLines = text.split(/\\r\\n|\\n|\\r/);\n      // Some CSVs have a header, so let's subtract 1 for the header row:\n      const totalRows = Math.max(allLines.length - 1, 1);\n      let parsedRows = 0;\n      Papa.parse(file, {\n        header: true,\n        skipEmptyLines: true,\n        worker: true,\n        // parse in a Web Worker\n        step: (results, parser) => {\n          // Called each time a row is parsed\n          const row = results.data;\n          // We can skip empty or invalid rows here if needed\n          if (row && Object.keys(row).length > 0) {\n            onRowParsed(row);\n          }\n          parsedRows++;\n          const percent = Math.min(100, parsedRows / totalRows * 100);\n          onProgress(percent);\n\n          // If all rows are parsed, we can stop (Papa sometimes calls step for the last \"empty\" row)\n          if (parsedRows >= totalRows) {\n            parser.abort();\n          }\n        },\n        complete: () => {\n          onComplete();\n        },\n        error: err => {\n          console.error(\"PapaParse Error:\", err);\n        }\n      });\n    };\n    reader.readAsText(file);\n  };\n\n  // ----------------------------------\n  // Handle Main CSV\n  // ----------------------------------\n  const handleMainCSVUpload = event => {\n    const file = event.target.files[0];\n    if (!file) return;\n    setMainCSVProgress(0);\n    parseCSVWithProgress(file, row => {\n      // Each valid row -> add to locations\n      const lat = parseFloat(row.LATITUDE);\n      const lng = parseFloat(row.LONGITUDE);\n      if (Number.isFinite(lat) && Number.isFinite(lng)) {\n        setLocations(prev => [...prev, {\n          coords: [lat, lng],\n          details: row\n        }]);\n      }\n    }, () => console.log(\"Main CSV done parsing.\"), progressPct => setMainCSVProgress(progressPct));\n  };\n\n  // ----------------------------------\n  // Handle Pricing CSV\n  // ----------------------------------\n  const handlePricingCSVUpload = event => {\n    const file = event.target.files[0];\n    if (!file) return;\n    setPricingCSVProgress(0);\n    parseCSVWithProgress(file, row => {\n      const lat = parseFloat(row.LATITUDE);\n      const lng = parseFloat(row.LONGITUDE);\n      if (Number.isFinite(lat) && Number.isFinite(lng) && row[\"APN - FORMATTED\"]) {\n        setPricingData(prev => [...prev, {\n          apn: row[\"APN - FORMATTED\"],\n          coords: [lat, lng],\n          lotAcreage: row[\"LOT ACREAGE\"] ? parseFloat(row[\"LOT ACREAGE\"]) : null\n        }]);\n      }\n    }, () => console.log(\"Pricing CSV done parsing.\"), progressPct => setPricingCSVProgress(progressPct));\n  };\n\n  // ----------------------------------\n  // Acreage filter + shape filter logic\n  // ----------------------------------\n  const applyAcreageFilter = () => {\n    const minVal = parseFloat(minAcreage);\n    const maxVal = parseFloat(maxAcreage);\n    if (isNaN(minVal) || isNaN(maxVal)) {\n      alert(\"Please enter valid numeric values for both min and max acreage.\");\n      return;\n    }\n    const filtered = pricingData.filter(pd => {\n      if (pd.lotAcreage == null) return false;\n      return pd.lotAcreage >= minVal && pd.lotAcreage <= maxVal;\n    });\n    setAcreageFilteredData(filtered);\n  };\n  const clearFilters = () => {\n    setShapeFilteredData([]);\n    setAcreageFilteredData([]);\n    setMinAcreage(\"\");\n    setMaxAcreage(\"\");\n  };\n  const downloadFilteredDataToExcel = () => {\n    const filteredPricingData = shapeFilteredData.filter(item => item.type === \"pricing\");\n    if (filteredPricingData.length === 0) {\n      alert(\"No data points within the drawn shape to download.\");\n      return;\n    }\n    const pricingDataTab = filteredPricingData.map(item => ({\n      APN: item.apn,\n      \"LOT ACREAGE\": item.lotAcreage,\n      Latitude: item.latitude,\n      Longitude: item.longitude\n    }));\n    const workbook = XLSX.utils.book_new();\n    const pricingSheet = XLSX.utils.json_to_sheet(pricingDataTab);\n    XLSX.utils.book_append_sheet(workbook, pricingSheet, \"Pricing Data\");\n    XLSX.writeFile(workbook, \"filtered_data.xlsx\");\n\n    // Remove exported APNs from the map data\n    const exportedAPNs = new Set(filteredPricingData.map(item => item.apn));\n    setLocations(prev => prev.filter(loc => !exportedAPNs.has(loc.details[\"APN - FORMATTED\"])));\n    setPricingData(prev => prev.filter(pt => !exportedAPNs.has(pt.apn)));\n\n    // Clear shape and acreage filters\n    setShapeFilteredData([]);\n    setAcreageFilteredData([]);\n    alert(\"Filtered data downloaded and removed from the map.\");\n  };\n\n  // Decide which pricing markers to display\n  const markersToDisplay = acreageFilteredData.length ? acreageFilteredData : pricingData;\n\n  // ----------------------------------\n  // UI for progress bars\n  // ----------------------------------\n  const ProgressBar = _ref3 => {\n    let {\n      progress\n    } = _ref3;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: \"8px\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: \"100%\",\n          height: \"8px\",\n          backgroundColor: \"#e0e0e0\",\n          borderRadius: \"4px\",\n          overflow: \"hidden\"\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: \"\".concat(progress.toFixed(1), \"%\"),\n            height: \"100%\",\n            background: \"#28a745\",\n            transition: \"width 0.2s\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 480,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 471,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n        style: {\n          color: \"#555\"\n        },\n        children: [progress.toFixed(1), \"%\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 489,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 470,\n      columnNumber: 7\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      height: \"100vh\",\n      width: \"100%\",\n      position: \"relative\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: \"absolute\",\n        zIndex: 1000,\n        top: 10,\n        right: 10,\n        background: \"#f8f9fa\",\n        padding: \"12px 15px\",\n        borderRadius: \"8px\",\n        boxShadow: \"0 3px 8px rgba(0,0,0,0.15)\",\n        width: \"280px\",\n        fontFamily: \"Arial, sans-serif\",\n        maxHeight: \"90vh\",\n        overflowY: \"auto\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(StateDropdown, {\n        states: states,\n        selectedStateUrl: selectedStateUrl,\n        onSelect: url => setSelectedStateUrl(url)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 513,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        style: {\n          marginTop: 0,\n          marginBottom: \"10px\"\n        },\n        children: \"Data Controls\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 518,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: \"15px\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          style: {\n            display: \"block\",\n            fontWeight: \"bold\"\n          },\n          children: \"Upload Main CSV:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 522,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          accept: \".csv\",\n          onChange: handleMainCSVUpload,\n          style: {\n            width: \"100%\",\n            marginTop: \"5px\",\n            padding: \"6px\",\n            border: \"1px solid #ccc\",\n            borderRadius: \"4px\",\n            cursor: \"pointer\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 525,\n          columnNumber: 11\n        }, this), mainCSVProgress > 0 && mainCSVProgress < 100 && /*#__PURE__*/_jsxDEV(ProgressBar, {\n          progress: mainCSVProgress\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 540,\n          columnNumber: 13\n        }, this), mainCSVProgress === 100 && /*#__PURE__*/_jsxDEV(\"small\", {\n          style: {\n            color: \"green\"\n          },\n          children: \"Main CSV Loaded!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 543,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 521,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: \"15px\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          style: {\n            display: \"block\",\n            fontWeight: \"bold\"\n          },\n          children: \"Upload Pricing CSV:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 549,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          accept: \".csv\",\n          onChange: handlePricingCSVUpload,\n          style: {\n            width: \"100%\",\n            marginTop: \"5px\",\n            padding: \"6px\",\n            border: \"1px solid #ccc\",\n            borderRadius: \"4px\",\n            cursor: \"pointer\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 552,\n          columnNumber: 11\n        }, this), pricingCSVProgress > 0 && pricingCSVProgress < 100 && /*#__PURE__*/_jsxDEV(ProgressBar, {\n          progress: pricingCSVProgress\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 567,\n          columnNumber: 13\n        }, this), pricingCSVProgress === 100 && /*#__PURE__*/_jsxDEV(\"small\", {\n          style: {\n            color: \"green\"\n          },\n          children: \"Pricing CSV Loaded!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 570,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 548,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: \"15px\",\n          border: \"1px solid #ccc\",\n          borderRadius: \"6px\",\n          padding: \"8px\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          style: {\n            fontWeight: \"bold\"\n          },\n          children: \"Acreage Filter\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 583,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: \"8px\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginBottom: \"4px\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Min Acreage:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 586,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              value: minAcreage,\n              onChange: e => setMinAcreage(e.target.value),\n              style: {\n                width: \"60px\",\n                marginLeft: \"15px\",\n                padding: \"2px 4px\"\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 587,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 585,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginBottom: \"15px\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Max Acreage:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 599,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              value: maxAcreage,\n              onChange: e => setMaxAcreage(e.target.value),\n              style: {\n                width: \"60px\",\n                marginLeft: \"10px\",\n                padding: \"2px 4px\"\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 600,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 598,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 584,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: applyAcreageFilter,\n          style: {\n            marginTop: \"10px\",\n            padding: \"6px 12px\",\n            background: \"#17a2b8\",\n            color: \"white\",\n            border: \"none\",\n            borderRadius: \"4px\",\n            cursor: \"pointer\"\n          },\n          children: \"Apply Filter\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 612,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: clearFilters,\n          style: {\n            marginTop: \"10px\",\n            marginLeft: \"10px\",\n            padding: \"6px 12px\",\n            background: \"#6c757d\",\n            color: \"white\",\n            border: \"none\",\n            borderRadius: \"4px\",\n            cursor: \"pointer\"\n          },\n          children: \"Clear Filter\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 626,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 575,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: downloadFilteredDataToExcel,\n        style: {\n          marginTop: \"5px\",\n          padding: \"8px 12px\",\n          background: \"#007bff\",\n          color: \"white\",\n          border: \"none\",\n          borderRadius: \"4px\",\n          cursor: \"pointer\",\n          width: \"100%\"\n        },\n        children: \"Download Filtered Data (Excel)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 644,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => deleteLastShapeRef.current(),\n        style: {\n          marginTop: \"10px\",\n          padding: \"8px 12px\",\n          background: \"#dc3545\",\n          color: \"white\",\n          border: \"none\",\n          borderRadius: \"4px\",\n          cursor: \"pointer\",\n          width: \"100%\"\n        },\n        children: \"\\uD83D\\uDDD1\\uFE0F Delete Selected Shape\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 661,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 497,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(MapContainer, {\n      center: [41.2033, -77.1945],\n      zoom: 7,\n      style: {\n        height: \"100%\",\n        width: \"100%\"\n      },\n      ref: mapRef,\n      children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n        url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",\n        attribution: \"\\xA9 OpenStreetMap contributors\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 684,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ZipOverlay, {\n        zipUrl: selectedStateUrl\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 688,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DrawHandler, {\n        setShapeFilteredData: setShapeFilteredData,\n        pricingDataRef: pricingDataRef,\n        locationsRef: locationsRef,\n        acreageFilteredDataRef: acreageFilteredDataRef,\n        setDeleteFunction: fn => {\n          deleteLastShapeRef.current = fn;\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 689,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(MarkerClusterGroup, {\n        chunkedLoading: true,\n        children: locations.filter(loc => Number.isFinite(loc.coords[0]) && Number.isFinite(loc.coords[1])).map((loc, index) => /*#__PURE__*/_jsxDEV(Marker, {\n          position: loc.coords,\n          icon: CustomMarkerIcon,\n          children: /*#__PURE__*/_jsxDEV(Tooltip, {\n            direction: \"top\",\n            offset: [0, -10],\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                textAlign: \"left\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"PRICE:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 715,\n                columnNumber: 21\n              }, this), \" \", loc.details.PRICE, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 716,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"ACRES:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 717,\n                columnNumber: 21\n              }, this), \" \", loc.details.ACRES]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 714,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 713,\n            columnNumber: 17\n          }, this)\n        }, \"main-\".concat(index), false, {\n          fileName: _jsxFileName,\n          lineNumber: 708,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 700,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(MarkerClusterGroup, {\n        chunkedLoading: true,\n        children: markersToDisplay.filter(item => {\n          const [lat, lng] = item.coords || [item.latitude, item.longitude];\n          return Number.isFinite(lat) && Number.isFinite(lng);\n        }).map((point, index) => {\n          const [lat, lng] = point.coords || [point.latitude, point.longitude];\n          return /*#__PURE__*/_jsxDEV(Marker, {\n            position: [lat, lng],\n            icon: DotIcon,\n            children: point.lotAcreage !== null && /*#__PURE__*/_jsxDEV(Tooltip, {\n              direction: \"top\",\n              offset: [0, -10],\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"LOT ACREAGE:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 743,\n                  columnNumber: 25\n                }, this), \" \", point.lotAcreage]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 742,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 741,\n              columnNumber: 21\n            }, this)\n          }, \"pricing-\".concat(index), false, {\n            fileName: _jsxFileName,\n            lineNumber: 735,\n            columnNumber: 17\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 725,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 678,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 495,\n    columnNumber: 5\n  }, this);\n}\n\n// ----------------------------------\n// StateDropdown – unchanged\n// ----------------------------------\n_s3(App, \"8KG0qFgFvgp0ZVxT79bhm7pCve4=\");\n_c3 = App;\nfunction StateDropdown(_ref4) {\n  _s4();\n  var _states$find;\n  let {\n    states,\n    selectedStateUrl,\n    onSelect\n  } = _ref4;\n  const [open, setOpen] = useState(false);\n  const [search, setSearch] = useState(\"\");\n  const toggleOpen = () => setOpen(!open);\n  const filteredStates = states.filter(st => st.name.toLowerCase().includes(search.toLowerCase()));\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      position: \"relative\",\n      marginBottom: \"10px\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      onClick: toggleOpen,\n      style: {\n        padding: \"6px\",\n        border: \"1px solid #ccc\",\n        borderRadius: \"4px\",\n        cursor: \"pointer\",\n        background: \"#fff\"\n      },\n      children: ((_states$find = states.find(s => s.url === selectedStateUrl)) === null || _states$find === void 0 ? void 0 : _states$find.name) || \"Select State\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 771,\n      columnNumber: 7\n    }, this), open && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: \"absolute\",\n        top: \"100%\",\n        left: 0,\n        right: 0,\n        background: \"#fff\",\n        border: \"1px solid #ccc\",\n        borderRadius: \"4px\",\n        maxHeight: \"200px\",\n        overflowY: \"auto\",\n        zIndex: 1001\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"Search state...\",\n        value: search,\n        onChange: e => setSearch(e.target.value),\n        style: {\n          width: \"100%\",\n          padding: \"6px\",\n          boxSizing: \"border-box\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 799,\n        columnNumber: 11\n      }, this), filteredStates.map(st => /*#__PURE__*/_jsxDEV(\"div\", {\n        onClick: () => {\n          onSelect(st.url);\n          setOpen(false);\n          setSearch(\"\");\n        },\n        style: {\n          padding: \"6px\",\n          cursor: \"pointer\",\n          borderBottom: \"1px solid #eee\"\n        },\n        children: st.name\n      }, st.name, false, {\n        fileName: _jsxFileName,\n        lineNumber: 807,\n        columnNumber: 13\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 785,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 770,\n    columnNumber: 5\n  }, this);\n}\n_s4(StateDropdown, \"OZaGxERzP9ofb5uNopqkD73Mc9A=\");\n_c4 = StateDropdown;\nexport default App;\nvar _c, _c2, _c3, _c4;\n$RefreshReg$(_c, \"ZipOverlay\");\n$RefreshReg$(_c2, \"DrawHandler\");\n$RefreshReg$(_c3, \"App\");\n$RefreshReg$(_c4, \"StateDropdown\");","map":{"version":3,"names":["React","useState","useRef","useEffect","MapContainer","TileLayer","Marker","Tooltip","useMap","Papa","L","booleanPointInPolygon","point","polygon","XLSX","MarkerClusterGroup","CustomMarkerIconImage","DotIconImage","jsxDEV","_jsxDEV","CustomMarkerIcon","icon","iconUrl","iconSize","iconAnchor","popupAnchor","DotIcon","states","name","url","ZipOverlay","_ref","_s","zipUrl","map","layersCache","Object","values","current","forEach","layer","removeLayer","currentLayer","addTo","fetch","then","res","json","geoData","geoJSON","style","color","weight","fillColor","fillOpacity","onEachFeature","feature","layerInstance","zip","properties","ZCTA5CE10","bindPopup","concat","catch","err","console","error","_c","DrawHandler","_ref2","_s2","setShapeFilteredData","pricingDataRef","locationsRef","setDeleteFunction","acreageFilteredDataRef","controlAdded","setControlAdded","drawnItemsRef","shapesArrayRef","selectedShapeRef","isPointInShape","lat","lng","Circle","CircleMarker","center","getLatLng","radius","getRadius","distance","latLng","shapeGeoJSON","toGeoJSON","polygonGeometry","geometry","coordinates","handleShapeDrawn","push","on","currentPricingData","length","filteredPricing","filter","p","coords","filteredComps","loc","combinedData","item","type","apn","lotAcreage","latitude","longitude","price","details","PRICE","acres","ACRES","log","drawnItems","FeatureGroup","addLayer","drawControl","Control","Draw","draw","marker","polyline","circle","shapeOptions","showRadius","circlemarker","showArea","rectangle","edit","featureGroup","addControl","e","shape","lastShape","pop","_c2","App","_s3","selectedStateUrl","setSelectedStateUrl","locations","setLocations","pricingData","setPricingData","shapeFilteredData","acreageFilteredData","setAcreageFilteredData","minAcreage","setMinAcreage","maxAcreage","setMaxAcreage","mainCSVProgress","setMainCSVProgress","pricingCSVProgress","setPricingCSVProgress","mapRef","deleteLastShapeRef","parseCSVWithProgress","file","onRowParsed","onComplete","onProgress","reader","FileReader","onload","text","target","result","allLines","split","totalRows","Math","max","parsedRows","parse","header","skipEmptyLines","worker","step","results","parser","row","data","keys","percent","min","abort","complete","readAsText","handleMainCSVUpload","event","files","parseFloat","LATITUDE","LONGITUDE","Number","isFinite","prev","progressPct","handlePricingCSVUpload","applyAcreageFilter","minVal","maxVal","isNaN","alert","filtered","pd","clearFilters","downloadFilteredDataToExcel","filteredPricingData","pricingDataTab","APN","Latitude","Longitude","workbook","utils","book_new","pricingSheet","json_to_sheet","book_append_sheet","writeFile","exportedAPNs","Set","has","pt","markersToDisplay","ProgressBar","_ref3","progress","marginTop","children","width","height","backgroundColor","borderRadius","overflow","toFixed","background","transition","fileName","_jsxFileName","lineNumber","columnNumber","position","zIndex","top","right","padding","boxShadow","fontFamily","maxHeight","overflowY","StateDropdown","onSelect","marginBottom","display","fontWeight","accept","onChange","border","cursor","value","marginLeft","onClick","zoom","ref","attribution","fn","chunkedLoading","index","direction","offset","textAlign","_c3","_ref4","_s4","_states$find","open","setOpen","search","setSearch","toggleOpen","filteredStates","st","toLowerCase","includes","find","s","left","placeholder","boxSizing","borderBottom","_c4","$RefreshReg$"],"sources":["C:/Users/CREATIVE_SOLUTIONS/Desktop/bolt/bolt codesandbox/src/App.js"],"sourcesContent":["// App.jsx\nimport React, { useState, useRef, useEffect } from \"react\";\nimport {\n  MapContainer,\n  TileLayer,\n  Marker,\n  Tooltip,\n  useMap,\n} from \"react-leaflet\";\nimport \"leaflet/dist/leaflet.css\";\nimport Papa from \"papaparse\";\nimport L from \"leaflet\";\nimport \"leaflet-draw/dist/leaflet.draw.css\";\nimport \"leaflet-draw\";\nimport booleanPointInPolygon from \"@turf/boolean-point-in-polygon\";\nimport { point, polygon } from \"@turf/helpers\";\nimport * as XLSX from \"xlsx\";\nimport MarkerClusterGroup from \"react-leaflet-cluster\";\n\n// Custom icons\nimport CustomMarkerIconImage from \"./custom-marker.png\";\nimport DotIconImage from \"./small-dot.png\";\n\nconst CustomMarkerIcon = L.icon({\n  iconUrl: CustomMarkerIconImage,\n  iconSize: [30, 40],\n  iconAnchor: [15, 40],\n  popupAnchor: [0, -40],\n});\nconst DotIcon = L.icon({\n  iconUrl: DotIconImage,\n  iconSize: [10, 10],\n  iconAnchor: [5, 5],\n});\n\n// ----- State dropdown data remains the same -----\nconst states = [\n  { name: \"Pennsylvania\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/master/pa_pennsylvania_zip_codes_geo.min.json\" },\n  { name: \"Alabama\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/al_alabama_zip_codes_geo.min.json\" },\n  { name: \"Alaska\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ak_alaska_zip_codes_geo.min.json\" },\n  { name: \"Arizona\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/az_arizona_zip_codes_geo.min.json\" },\n  { name: \"Arkansas\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ar_arkansas_zip_codes_geo.min.json\" },\n  { name: \"California\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ca_california_zip_codes_geo.min.json\" },\n  { name: \"Colorado\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/co_colorado_zip_codes_geo.min.json\" },\n  { name: \"Connecticut\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ct_connecticut_zip_codes_geo.min.json\" },\n  { name: \"Delaware\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/de_delaware_zip_codes_geo.min.json\" },\n  { name: \"District of Columbia\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/dc_district_of_columbia_zip_codes_geo.min.json\" },\n  { name: \"Florida\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/fl_florida_zip_codes_geo.min.json\" },\n  { name: \"Georgia\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ga_georgia_zip_codes_geo.min.json\" },\n  { name: \"Hawaii\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/hi_hawaii_zip_codes_geo.min.json\" },\n  { name: \"Idaho\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/id_idaho_zip_codes_geo.min.json\" },\n  { name: \"Illinois\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/il_illinois_zip_codes_geo.min.json\" },\n  { name: \"Indiana\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/in_indiana_zip_codes_geo.min.json\" },\n  { name: \"Iowa\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ia_iowa_zip_codes_geo.min.json\" },\n  { name: \"Kansas\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ks_kansas_zip_codes_geo.min.json\" },\n  { name: \"Kentucky\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ky_kentucky_zip_codes_geo.min.json\" },\n  { name: \"Louisiana\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/la_louisiana_zip_codes_geo.min.json\" },\n  { name: \"Maine\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/me_maine_zip_codes_geo.min.json\" },\n  { name: \"Maryland\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/md_maryland_zip_codes_geo.min.json\" },\n  { name: \"Massachusetts\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ma_massachusetts_zip_codes_geo.min.json\" },\n  { name: \"Michigan\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/mi_michigan_zip_codes_geo.min.json\" },\n  { name: \"Minnesota\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/mn_minnesota_zip_codes_geo.min.json\" },\n  { name: \"Mississippi\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ms_mississippi_zip_codes_geo.min.json\" },\n  { name: \"Missouri\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/mo_missouri_zip_codes_geo.min.json\" },\n  { name: \"Montana\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/mt_montana_zip_codes_geo.min.json\" },\n  { name: \"Nebraska\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ne_nebraska_zip_codes_geo.min.json\" },\n  { name: \"Nevada\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/nv_nevada_zip_codes_geo.min.json\" },\n  { name: \"New Hampshire\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/nh_new_hampshire_zip_codes_geo.min.json\" },\n  { name: \"New Jersey\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/nj_new_jersey_zip_codes_geo.min.json\" },\n  { name: \"New Mexico\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/nm_new_mexico_zip_codes_geo.min.json\" },\n  { name: \"New York\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ny_new_york_zip_codes_geo.min.json\" },\n  { name: \"North Carolina\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/nc_north_carolina_zip_codes_geo.min.json\" },\n  { name: \"North Dakota\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/nd_north_dakota_zip_codes_geo.min.json\" },\n  { name: \"Ohio\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/oh_ohio_zip_codes_geo.min.json\" },\n  { name: \"Oklahoma\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ok_oklahoma_zip_codes_geo.min.json\" },\n  { name: \"Oregon\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/or_oregon_zip_codes_geo.min.json\" },\n  { name: \"Rhode Island\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ri_rhode_island_zip_codes_geo.min.json\" },\n  { name: \"South Carolina\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/sc_south_carolina_zip_codes_geo.min.json\" },\n  { name: \"South Dakota\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/sd_south_dakota_zip_codes_geo.min.json\" },\n  { name: \"Tennessee\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/tn_tennessee_zip_codes_geo.min.json\" },\n  { name: \"Texas\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/tx_texas_zip_codes_geo.min.json\" },\n  { name: \"Utah\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/ut_utah_zip_codes_geo.min.json\" },\n  { name: \"Vermont\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/vt_vermont_zip_codes_geo.min.json\" },\n  { name: \"Virginia\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/va_virginia_zip_codes_geo.min.json\" },\n  { name: \"Washington\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/wa_washington_zip_codes_geo.min.json\" },\n  { name: \"West Virginia\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/wv_west_virginia_zip_codes_geo.min.json\" },\n  { name: \"Wisconsin\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/wi_wisconsin_zip_codes_geo.min.json\" },\n  { name: \"Wyoming\", url: \"https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/refs/heads/master/wy_wyoming_zip_codes_geo.min.json\" },\n];\n\n// ----------------------------------\n// ZipOverlay – unchanged\n// ----------------------------------\nfunction ZipOverlay({ zipUrl }) {\n  const map = useMap();\n  const layersCache = useRef({});\n\n  useEffect(() => {\n    if (!zipUrl) return;\n    Object.values(layersCache.current).forEach((layer) => map.removeLayer(layer));\n    let currentLayer;\n\n    if (layersCache.current[zipUrl]) {\n      currentLayer = layersCache.current[zipUrl];\n      currentLayer.addTo(map);\n    } else {\n      fetch(zipUrl)\n        .then((res) => res.json())\n        .then((geoData) => {\n          currentLayer = L.geoJSON(geoData, {\n            style: {\n              color: \"#ff7800\",\n              weight: 1,\n              fillColor: \"#ffeda0\",\n              fillOpacity: 0.4,\n            },\n            onEachFeature: (feature, layerInstance) => {\n              const zip = feature.properties.ZCTA5CE10 || \"Unknown ZIP\";\n              layerInstance.bindPopup(`ZIP Code: ${zip}`);\n            },\n          });\n          layersCache.current[zipUrl] = currentLayer;\n          currentLayer.addTo(map);\n        })\n        .catch((err) => console.error(\"Error fetching ZIP code GeoJSON:\", err));\n    }\n\n    return () => {\n      if (currentLayer) map.removeLayer(currentLayer);\n    };\n  }, [map, zipUrl]);\n\n  return null;\n}\n\n// ----------------------------------\n// DrawHandler – unchanged (just shortened comments)\n// ----------------------------------\nfunction DrawHandler({\n  setShapeFilteredData,\n  pricingDataRef,\n  locationsRef,\n  setDeleteFunction,\n  acreageFilteredDataRef,\n}) {\n  const map = useMap();\n  const [controlAdded, setControlAdded] = useState(false);\n  const drawnItemsRef = useRef(null);\n  const shapesArrayRef = useRef([]);\n  const selectedShapeRef = useRef(null);\n\n  const isPointInShape = (lat, lng, layer) => {\n    if (layer instanceof L.Circle || layer instanceof L.CircleMarker) {\n      const center = layer.getLatLng();\n      const radius = layer.getRadius();\n      return map.distance(center, L.latLng(lat, lng)) <= radius;\n    }\n    const shapeGeoJSON = layer.toGeoJSON();\n    const polygonGeometry = polygon(shapeGeoJSON.geometry.coordinates);\n    return booleanPointInPolygon(point([lng, lat]), polygonGeometry);\n  };\n\n  const handleShapeDrawn = (layer) => {\n    shapesArrayRef.current.push(layer);\n    layer.on(\"click\", () => {\n      selectedShapeRef.current = layer;\n    });\n\n    // Use filtered data if available, else entire pricing data\n    const currentPricingData = acreageFilteredDataRef.current.length\n      ? acreageFilteredDataRef.current\n      : pricingDataRef.current;\n\n    const filteredPricing = currentPricingData.filter((p) => {\n      const [lat, lng] = p.coords;\n      return isPointInShape(lat, lng, layer);\n    });\n\n    const filteredComps = locationsRef.current.filter((loc) => {\n      const [lat, lng] = loc.coords;\n      return isPointInShape(lat, lng, layer);\n    });\n\n    const combinedData = [\n      ...filteredPricing.map((item) => ({\n        type: \"pricing\",\n        apn: item.apn,\n        lotAcreage: item.lotAcreage,\n        latitude: item.coords[0],\n        longitude: item.coords[1],\n      })),\n      ...filteredComps.map((item) => ({\n        type: \"comps\",\n        price: item.details.PRICE,\n        acres: item.details.ACRES,\n        latitude: item.coords[0],\n        longitude: item.coords[1],\n      })),\n    ];\n\n    setShapeFilteredData(combinedData);\n    console.log(\"Shape Filtered Data:\", combinedData);\n  };\n\n  useEffect(() => {\n    if (!controlAdded) {\n      const drawnItems = new L.FeatureGroup();\n      drawnItemsRef.current = drawnItems;\n      map.addLayer(drawnItems);\n      const drawControl = new L.Control.Draw({\n        draw: {\n          marker: false,\n          polyline: false,\n          circle: { shapeOptions: { color: \"#ff0000\" }, showRadius: true },\n          circlemarker: false,\n          polygon: { shapeOptions: { color: \"#0000ff\" }, showArea: true },\n          rectangle: { shapeOptions: { color: \"#00ff00\" } },\n        },\n        edit: { featureGroup: drawnItems },\n      });\n      map.addControl(drawControl);\n      setControlAdded(true);\n\n      map.on(\"draw:created\", (e) => {\n        const { layer } = e;\n        drawnItems.addLayer(layer);\n        handleShapeDrawn(layer);\n      });\n\n      setDeleteFunction(() => {\n        if (selectedShapeRef.current && drawnItemsRef.current) {\n          drawnItemsRef.current.removeLayer(selectedShapeRef.current);\n          shapesArrayRef.current = shapesArrayRef.current.filter(\n            (shape) => shape !== selectedShapeRef.current\n          );\n          selectedShapeRef.current = null;\n        } else if (shapesArrayRef.current.length > 0) {\n          const lastShape = shapesArrayRef.current.pop();\n          if (lastShape && drawnItemsRef.current) {\n            drawnItemsRef.current.removeLayer(lastShape);\n          }\n        }\n      });\n    }\n  }, [\n    map,\n    controlAdded,\n    pricingDataRef,\n    locationsRef,\n    setShapeFilteredData,\n    setDeleteFunction,\n    acreageFilteredDataRef,\n  ]);\n\n  return null;\n}\n\n// ----------------------------------\n// App\n// ----------------------------------\nfunction App() {\n  const [selectedStateUrl, setSelectedStateUrl] = useState(states[0].url);\n  const [locations, setLocations] = useState([]);\n  const [pricingData, setPricingData] = useState([]);\n  const [shapeFilteredData, setShapeFilteredData] = useState([]);\n  const [acreageFilteredData, setAcreageFilteredData] = useState([]);\n  const [minAcreage, setMinAcreage] = useState(\"\");\n  const [maxAcreage, setMaxAcreage] = useState(\"\");\n\n  // For progress bars\n  const [mainCSVProgress, setMainCSVProgress] = useState(0);\n  const [pricingCSVProgress, setPricingCSVProgress] = useState(0);\n\n  // Refs\n  const pricingDataRef = useRef(pricingData);\n  const locationsRef = useRef(locations);\n  const acreageFilteredDataRef = useRef(acreageFilteredData);\n\n  const mapRef = useRef(null);\n  const deleteLastShapeRef = useRef(() => {});\n\n  // Keep references in sync\n  useEffect(() => {\n    pricingDataRef.current = pricingData;\n  }, [pricingData]);\n  useEffect(() => {\n    locationsRef.current = locations;\n  }, [locations]);\n  useEffect(() => {\n    acreageFilteredDataRef.current = acreageFilteredData;\n  }, [acreageFilteredData]);\n\n  // ----------------------------------\n  // Generic CSV parse with progress\n  // ----------------------------------\n  const parseCSVWithProgress = (file, onRowParsed, onComplete, onProgress) => {\n    // 1) First read the entire file as text to estimate #lines (minus header).\n    const reader = new FileReader();\n    reader.onload = (e) => {\n      const text = e.target.result;\n      const allLines = text.split(/\\r\\n|\\n|\\r/);\n      // Some CSVs have a header, so let's subtract 1 for the header row:\n      const totalRows = Math.max(allLines.length - 1, 1);\n\n      let parsedRows = 0;\n\n      Papa.parse(file, {\n        header: true,\n        skipEmptyLines: true,\n        worker: true, // parse in a Web Worker\n        step: (results, parser) => {\n          // Called each time a row is parsed\n          const row = results.data;\n          // We can skip empty or invalid rows here if needed\n          if (row && Object.keys(row).length > 0) {\n            onRowParsed(row);\n          }\n          parsedRows++;\n          const percent = Math.min(100, (parsedRows / totalRows) * 100);\n          onProgress(percent);\n\n          // If all rows are parsed, we can stop (Papa sometimes calls step for the last \"empty\" row)\n          if (parsedRows >= totalRows) {\n            parser.abort();\n          }\n        },\n        complete: () => {\n          onComplete();\n        },\n        error: (err) => {\n          console.error(\"PapaParse Error:\", err);\n        },\n      });\n    };\n    reader.readAsText(file);\n  };\n\n  // ----------------------------------\n  // Handle Main CSV\n  // ----------------------------------\n  const handleMainCSVUpload = (event) => {\n    const file = event.target.files[0];\n    if (!file) return;\n\n    setMainCSVProgress(0);\n\n    parseCSVWithProgress(\n      file,\n      (row) => {\n        // Each valid row -> add to locations\n        const lat = parseFloat(row.LATITUDE);\n        const lng = parseFloat(row.LONGITUDE);\n        if (Number.isFinite(lat) && Number.isFinite(lng)) {\n          setLocations((prev) => [\n            ...prev,\n            { coords: [lat, lng], details: row },\n          ]);\n        }\n      },\n      () => console.log(\"Main CSV done parsing.\"),\n      (progressPct) => setMainCSVProgress(progressPct)\n    );\n  };\n\n  // ----------------------------------\n  // Handle Pricing CSV\n  // ----------------------------------\n  const handlePricingCSVUpload = (event) => {\n    const file = event.target.files[0];\n    if (!file) return;\n\n    setPricingCSVProgress(0);\n\n    parseCSVWithProgress(\n      file,\n      (row) => {\n        const lat = parseFloat(row.LATITUDE);\n        const lng = parseFloat(row.LONGITUDE);\n        if (\n          Number.isFinite(lat) &&\n          Number.isFinite(lng) &&\n          row[\"APN - FORMATTED\"]\n        ) {\n          setPricingData((prev) => [\n            ...prev,\n            {\n              apn: row[\"APN - FORMATTED\"],\n              coords: [lat, lng],\n              lotAcreage: row[\"LOT ACREAGE\"]\n                ? parseFloat(row[\"LOT ACREAGE\"])\n                : null,\n            },\n          ]);\n        }\n      },\n      () => console.log(\"Pricing CSV done parsing.\"),\n      (progressPct) => setPricingCSVProgress(progressPct)\n    );\n  };\n\n  // ----------------------------------\n  // Acreage filter + shape filter logic\n  // ----------------------------------\n  const applyAcreageFilter = () => {\n    const minVal = parseFloat(minAcreage);\n    const maxVal = parseFloat(maxAcreage);\n    if (isNaN(minVal) || isNaN(maxVal)) {\n      alert(\"Please enter valid numeric values for both min and max acreage.\");\n      return;\n    }\n    const filtered = pricingData.filter((pd) => {\n      if (pd.lotAcreage == null) return false;\n      return pd.lotAcreage >= minVal && pd.lotAcreage <= maxVal;\n    });\n    setAcreageFilteredData(filtered);\n  };\n\n  const clearFilters = () => {\n    setShapeFilteredData([]);\n    setAcreageFilteredData([]);\n    setMinAcreage(\"\");\n    setMaxAcreage(\"\");\n  };\n\n  const downloadFilteredDataToExcel = () => {\n    const filteredPricingData = shapeFilteredData.filter(\n      (item) => item.type === \"pricing\"\n    );\n    if (filteredPricingData.length === 0) {\n      alert(\"No data points within the drawn shape to download.\");\n      return;\n    }\n\n    const pricingDataTab = filteredPricingData.map((item) => ({\n      APN: item.apn,\n      \"LOT ACREAGE\": item.lotAcreage,\n      Latitude: item.latitude,\n      Longitude: item.longitude,\n    }));\n\n    const workbook = XLSX.utils.book_new();\n    const pricingSheet = XLSX.utils.json_to_sheet(pricingDataTab);\n    XLSX.utils.book_append_sheet(workbook, pricingSheet, \"Pricing Data\");\n    XLSX.writeFile(workbook, \"filtered_data.xlsx\");\n\n    // Remove exported APNs from the map data\n    const exportedAPNs = new Set(filteredPricingData.map((item) => item.apn));\n    setLocations((prev) =>\n      prev.filter((loc) => !exportedAPNs.has(loc.details[\"APN - FORMATTED\"]))\n    );\n    setPricingData((prev) => prev.filter((pt) => !exportedAPNs.has(pt.apn)));\n\n    // Clear shape and acreage filters\n    setShapeFilteredData([]);\n    setAcreageFilteredData([]);\n\n    alert(\"Filtered data downloaded and removed from the map.\");\n  };\n\n  // Decide which pricing markers to display\n  const markersToDisplay = acreageFilteredData.length\n    ? acreageFilteredData\n    : pricingData;\n\n  // ----------------------------------\n  // UI for progress bars\n  // ----------------------------------\n  const ProgressBar = ({ progress }) => {\n    return (\n      <div style={{ marginTop: \"8px\" }}>\n        <div\n          style={{\n            width: \"100%\",\n            height: \"8px\",\n            backgroundColor: \"#e0e0e0\",\n            borderRadius: \"4px\",\n            overflow: \"hidden\",\n          }}\n        >\n          <div\n            style={{\n              width: `${progress.toFixed(1)}%`,\n              height: \"100%\",\n              background: \"#28a745\",\n              transition: \"width 0.2s\",\n            }}\n          />\n        </div>\n        <small style={{ color: \"#555\" }}>{progress.toFixed(1)}%</small>\n      </div>\n    );\n  };\n\n  return (\n    <div style={{ height: \"100vh\", width: \"100%\", position: \"relative\" }}>\n      {/* Control Panel */}\n      <div\n        style={{\n          position: \"absolute\",\n          zIndex: 1000,\n          top: 10,\n          right: 10,\n          background: \"#f8f9fa\",\n          padding: \"12px 15px\",\n          borderRadius: \"8px\",\n          boxShadow: \"0 3px 8px rgba(0,0,0,0.15)\",\n          width: \"280px\",\n          fontFamily: \"Arial, sans-serif\",\n          maxHeight: \"90vh\",\n          overflowY: \"auto\",\n        }}\n      >\n        <StateDropdown\n          states={states}\n          selectedStateUrl={selectedStateUrl}\n          onSelect={(url) => setSelectedStateUrl(url)}\n        />\n        <h3 style={{ marginTop: 0, marginBottom: \"10px\" }}>Data Controls</h3>\n\n        {/* Main CSV Upload */}\n        <div style={{ marginBottom: \"15px\" }}>\n          <label style={{ display: \"block\", fontWeight: \"bold\" }}>\n            Upload Main CSV:\n          </label>\n          <input\n            type=\"file\"\n            accept=\".csv\"\n            onChange={handleMainCSVUpload}\n            style={{\n              width: \"100%\",\n              marginTop: \"5px\",\n              padding: \"6px\",\n              border: \"1px solid #ccc\",\n              borderRadius: \"4px\",\n              cursor: \"pointer\",\n            }}\n          />\n          {/* Progress bar for main CSV */}\n          {mainCSVProgress > 0 && mainCSVProgress < 100 && (\n            <ProgressBar progress={mainCSVProgress} />\n          )}\n          {mainCSVProgress === 100 && (\n            <small style={{ color: \"green\" }}>Main CSV Loaded!</small>\n          )}\n        </div>\n\n        {/* Pricing CSV Upload */}\n        <div style={{ marginBottom: \"15px\" }}>\n          <label style={{ display: \"block\", fontWeight: \"bold\" }}>\n            Upload Pricing CSV:\n          </label>\n          <input\n            type=\"file\"\n            accept=\".csv\"\n            onChange={handlePricingCSVUpload}\n            style={{\n              width: \"100%\",\n              marginTop: \"5px\",\n              padding: \"6px\",\n              border: \"1px solid #ccc\",\n              borderRadius: \"4px\",\n              cursor: \"pointer\",\n            }}\n          />\n          {/* Progress bar for pricing CSV */}\n          {pricingCSVProgress > 0 && pricingCSVProgress < 100 && (\n            <ProgressBar progress={pricingCSVProgress} />\n          )}\n          {pricingCSVProgress === 100 && (\n            <small style={{ color: \"green\" }}>Pricing CSV Loaded!</small>\n          )}\n        </div>\n\n        {/* Acreage Filter */}\n        <div\n          style={{\n            marginBottom: \"15px\",\n            border: \"1px solid #ccc\",\n            borderRadius: \"6px\",\n            padding: \"8px\",\n          }}\n        >\n          <label style={{ fontWeight: \"bold\" }}>Acreage Filter</label>\n          <div style={{ marginTop: \"8px\" }}>\n            <div style={{ marginBottom: \"4px\" }}>\n              <label>Min Acreage:</label>\n              <input\n                type=\"number\"\n                value={minAcreage}\n                onChange={(e) => setMinAcreage(e.target.value)}\n                style={{\n                  width: \"60px\",\n                  marginLeft: \"15px\",\n                  padding: \"2px 4px\",\n                }}\n              />\n            </div>\n            <div style={{ marginBottom: \"15px\" }}>\n              <label>Max Acreage:</label>\n              <input\n                type=\"number\"\n                value={maxAcreage}\n                onChange={(e) => setMaxAcreage(e.target.value)}\n                style={{\n                  width: \"60px\",\n                  marginLeft: \"10px\",\n                  padding: \"2px 4px\",\n                }}\n              />\n            </div>\n          </div>\n          <button\n            onClick={applyAcreageFilter}\n            style={{\n              marginTop: \"10px\",\n              padding: \"6px 12px\",\n              background: \"#17a2b8\",\n              color: \"white\",\n              border: \"none\",\n              borderRadius: \"4px\",\n              cursor: \"pointer\",\n            }}\n          >\n            Apply Filter\n          </button>\n          <button\n            onClick={clearFilters}\n            style={{\n              marginTop: \"10px\",\n              marginLeft: \"10px\",\n              padding: \"6px 12px\",\n              background: \"#6c757d\",\n              color: \"white\",\n              border: \"none\",\n              borderRadius: \"4px\",\n              cursor: \"pointer\",\n            }}\n          >\n            Clear Filter\n          </button>\n        </div>\n\n        {/* Download Filtered Data */}\n        <button\n          onClick={downloadFilteredDataToExcel}\n          style={{\n            marginTop: \"5px\",\n            padding: \"8px 12px\",\n            background: \"#007bff\",\n            color: \"white\",\n            border: \"none\",\n            borderRadius: \"4px\",\n            cursor: \"pointer\",\n            width: \"100%\",\n          }}\n        >\n          Download Filtered Data (Excel)\n        </button>\n\n        {/* Delete shape */}\n        <button\n          onClick={() => deleteLastShapeRef.current()}\n          style={{\n            marginTop: \"10px\",\n            padding: \"8px 12px\",\n            background: \"#dc3545\",\n            color: \"white\",\n            border: \"none\",\n            borderRadius: \"4px\",\n            cursor: \"pointer\",\n            width: \"100%\",\n          }}\n        >\n          🗑️ Delete Selected Shape\n        </button>\n      </div>\n\n      <MapContainer\n        center={[41.2033, -77.1945]}\n        zoom={7}\n        style={{ height: \"100%\", width: \"100%\" }}\n        ref={mapRef}\n      >\n        <TileLayer\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n          attribution=\"&copy; OpenStreetMap contributors\"\n        />\n        <ZipOverlay zipUrl={selectedStateUrl} />\n        <DrawHandler\n          setShapeFilteredData={setShapeFilteredData}\n          pricingDataRef={pricingDataRef}\n          locationsRef={locationsRef}\n          acreageFilteredDataRef={acreageFilteredDataRef}\n          setDeleteFunction={(fn) => {\n            deleteLastShapeRef.current = fn;\n          }}\n        />\n\n        {/* Main CSV (comps) markers in a cluster */}\n        <MarkerClusterGroup chunkedLoading>\n          {locations\n            .filter(\n              (loc) =>\n                Number.isFinite(loc.coords[0]) &&\n                Number.isFinite(loc.coords[1])\n            )\n            .map((loc, index) => (\n              <Marker\n                key={`main-${index}`}\n                position={loc.coords}\n                icon={CustomMarkerIcon}\n              >\n                <Tooltip direction=\"top\" offset={[0, -10]}>\n                  <div style={{ textAlign: \"left\" }}>\n                    <strong>PRICE:</strong> {loc.details.PRICE}\n                    <br />\n                    <strong>ACRES:</strong> {loc.details.ACRES}\n                  </div>\n                </Tooltip>\n              </Marker>\n            ))}\n        </MarkerClusterGroup>\n\n        {/* Pricing CSV markers in a cluster */}\n        <MarkerClusterGroup chunkedLoading>\n          {markersToDisplay\n            .filter((item) => {\n              const [lat, lng] = item.coords || [item.latitude, item.longitude];\n              return Number.isFinite(lat) && Number.isFinite(lng);\n            })\n            .map((point, index) => {\n              const [lat, lng] =\n                point.coords || [point.latitude, point.longitude];\n              return (\n                <Marker\n                  key={`pricing-${index}`}\n                  position={[lat, lng]}\n                  icon={DotIcon}\n                >\n                  {point.lotAcreage !== null && (\n                    <Tooltip direction=\"top\" offset={[0, -10]}>\n                      <div>\n                        <strong>LOT ACREAGE:</strong> {point.lotAcreage}\n                      </div>\n                    </Tooltip>\n                  )}\n                </Marker>\n              );\n            })}\n        </MarkerClusterGroup>\n      </MapContainer>\n    </div>\n  );\n}\n\n// ----------------------------------\n// StateDropdown – unchanged\n// ----------------------------------\nfunction StateDropdown({ states, selectedStateUrl, onSelect }) {\n  const [open, setOpen] = useState(false);\n  const [search, setSearch] = useState(\"\");\n\n  const toggleOpen = () => setOpen(!open);\n\n  const filteredStates = states.filter((st) =>\n    st.name.toLowerCase().includes(search.toLowerCase())\n  );\n\n  return (\n    <div style={{ position: \"relative\", marginBottom: \"10px\" }}>\n      <div\n        onClick={toggleOpen}\n        style={{\n          padding: \"6px\",\n          border: \"1px solid #ccc\",\n          borderRadius: \"4px\",\n          cursor: \"pointer\",\n          background: \"#fff\",\n        }}\n      >\n        {states.find((s) => s.url === selectedStateUrl)?.name ||\n          \"Select State\"}\n      </div>\n      {open && (\n        <div\n          style={{\n            position: \"absolute\",\n            top: \"100%\",\n            left: 0,\n            right: 0,\n            background: \"#fff\",\n            border: \"1px solid #ccc\",\n            borderRadius: \"4px\",\n            maxHeight: \"200px\",\n            overflowY: \"auto\",\n            zIndex: 1001,\n          }}\n        >\n          <input\n            type=\"text\"\n            placeholder=\"Search state...\"\n            value={search}\n            onChange={(e) => setSearch(e.target.value)}\n            style={{ width: \"100%\", padding: \"6px\", boxSizing: \"border-box\" }}\n          />\n          {filteredStates.map((st) => (\n            <div\n              key={st.name}\n              onClick={() => {\n                onSelect(st.url);\n                setOpen(false);\n                setSearch(\"\");\n              }}\n              style={{\n                padding: \"6px\",\n                cursor: \"pointer\",\n                borderBottom: \"1px solid #eee\",\n              }}\n            >\n              {st.name}\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}